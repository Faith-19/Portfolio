<html
⌄
⌄
⌄
⌄
⌄
⌄
⌄
⌄
⌄
⌄

⌄
 lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weather Forecast</title>
  
  <!-- TailwindCSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- FontAwesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Animate.css for smooth transitions -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  
  <style id="app-style">
    .dark {
      --bg-primary: #121212;
      --bg-secondary: #1e1e1e;
      --text-primary: #ffffff;
      --text-secondary: #b0b0b0;
      --accent: #5b8def;
    }
    
    .light {
      --bg-primary: #f5f7fa;
      --bg-secondary: #ffffff;
      --text-primary: #2d3748;
      --text-secondary: #4a5568;
      --accent: #3182ce;
    }
    
    body {
      background-color: var(--bg-primary);
      color: var(--text-primary);
      transition: background-color 0.3s, color 0.3s;
      min-height: 100vh;
    }
    
    .weather-card {
      background-color: var(--bg-secondary);
      border-radius: 1.5rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    .forecast-card {
      background-color: var(--bg-secondary);
      border-radius: 1rem;
      transition: transform 0.2s;
    }
    
    .forecast-card:hover {
      transform: translateY(-5px);
    }
    
    .skeleton {
      background: linear-gradient(90deg, var(--bg-secondary), rgba(255,255,255,0.1), var(--bg-secondary));
      background-size: 200% 100%;
      animation: loading 1.5s infinite;
    }
    
    @keyframes loading {
      0% {
        background-position: 200% 0;
      }
      100% {
        background-position: -200% 0;
      }
    }
    
    .toggle-switch {
      position: relative;
      width: 60px;
      height: 30px;
      border-radius: 15px;
      background-color: #4a5568;
      transition: background-color 0.3s;
    }
    
    .toggle-switch:before {
      content: "";
      position: absolute;
      width: 26px;
      height: 26px;
      left: 2px;
      top: 2px;
      border-radius: 50%;
      background: white;
      transition: transform 0.3s;
    }
    
    .toggle-switch.active {
      background-color: var(--accent);
    }
    
    .toggle-switch.active:before {
      transform: translateX(30px);
    }
    
    /* Hide scrollbar while maintaining functionality */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-thumb {
      background-color: var(--accent);
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-track {
      background: transparent;
    }
  </style>
</head>
<body class="dark font-sans">
  <div class="container mx-auto px-4 py-6 max-w-5xl">
    <!-- Header -->
    <header class="flex justify-between items-center mb-8">
      <div>
        <h1 class="text-3xl font-bold">Weather Forecast</h1>
        <p id="location" class="text-lg text-gray-400">
          <i class="fas fa-location-dot mr-2"></i>
          <span id="city-name">Detecting location...</span>
        </p>
      </div>
      <div class="flex items-center space-x-4">
        <button id="refresh-btn" class="p-2 rounded-full hover:bg-gray-700 transition-colors" aria-label="Refresh weather data">
          <i class="fas fa-sync-alt text-xl"></i>
        </button>
        <div class="flex items-center">
          <i class="fas fa-moon text-gray-400 mr-2"></i>
          <div id="theme-toggle" class="toggle-switch active" role="switch" aria-checked="true" tabindex="0"></div>
          <i class="fas fa-sun text-gray-400 ml-2"></i>
        </div>
      </div>
    </header>
    
    <!-- Error message container -->
    <div id="error-container" class="hidden bg-red-500 text-white p-4 rounded-lg mb-6 animate__animated animate__fadeIn">
      <div class="flex items-center">
        <i class="fas fa-exclamation-circle text-2xl mr-3"></i>
        <p id="error-message">Unable to retrieve weather data. Please try again later.</p>
      </div>
    </div>
    
    <!-- Loading state -->
    <div id="loading-container" class="animate__animated animate__fadeIn">
      <div class="weather-card p-6 mb-8">
        <div class="flex flex-col md:flex-row items-center">
          <div class="w-full md:w-1/2 flex flex-col items-center mb-6 md:mb-0">
            <div class="skeleton w-32 h-32 rounded-full mb-4"></div>
            <div class="skeleton w-40 h-12 rounded-md"></div>
          </div>
          <div class="w-full md:w-1/2">
            <div class="skeleton w-full h-8 rounded-md mb-4"></div>
            <div class="skeleton w-3/4 h-6 rounded-md mb-3"></div>
            <div class="skeleton w-3/4 h-6 rounded-md mb-3"></div>
            <div class="skeleton w-3/4 h-6 rounded-md"></div>
          </div>
        </div>
      </div>
      
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4">
        <div class="forecast-card p-4 flex flex-col items-center">
          <div class="skeleton w-full h-6 rounded-md mb-3"></div>
          <div class="skeleton w-16 h-16 rounded-full mb-3"></div>
          <div class="skeleton w-3/4 h-6 rounded-md mb-2"></div>
          <div class="skeleton w-1/2 h-6 rounded-md"></div>
        </div>
        <div class="forecast-card p-4 flex flex-col items-center">
          <div class="skeleton w-full h-6 rounded-md mb-3"></div>
          <div class="skeleton w-16 h-16 rounded-full mb-3"></div>
          <div class="skeleton w-3/4 h-6 rounded-md mb-2"></div>
          <div class="skeleton w-1/2 h-6 rounded-md"></div>
        </div>
        <div class="forecast-card p-4 flex flex-col items-center">
          <div class="skeleton w-full h-6 rounded-md mb-3"></div>
          <div class="skeleton w-16 h-16 rounded-full mb-3"></div>
          <div class="skeleton w-3/4 h-6 rounded-md mb-2"></div>
          <div class="skeleton w-1/2 h-6 rounded-md"></div>
        </div>
        <div class="forecast-card p-4 flex flex-col items-center hidden sm:flex">
          <div class="skeleton w-full h-6 rounded-md mb-3"></div>
          <div class="skeleton w-16 h-16 rounded-full mb-3"></div>
          <div class="skeleton w-3/4 h-6 rounded-md mb-2"></div>
          <div class="skeleton w-1/2 h-6 rounded-md"></div>
        </div>
        <div class="forecast-card p-4 flex flex-col items-center hidden md:flex">
          <div class="skeleton w-full h-6 rounded-md mb-3"></div>
          <div class="skeleton w-16 h-16 rounded-full mb-3"></div>
          <div class="skeleton w-3/4 h-6 rounded-md mb-2"></div>
          <div class="skeleton w-1/2 h-6 rounded-md"></div>
        </div>
      </div>
    </div>
    
    <!-- Weather content -->
    <div id="weather-container" class="hidden animate__animated animate__fadeIn">
      <!-- Current weather card -->
      <div class="weather-card p-6 mb-8">
        <div class="flex flex-col md:flex-row items-center">
          <div class="w-full md:w-1/2 flex flex-col items-center mb-6 md:mb-0">
            <img id="current-weather-icon" src="" alt="Weather condition" class="w-32 h-32 mb-2">
            <h2 id="current-temp" class="text-5xl font-bold">--°</h2>
            <p id="current-description" class="text-xl text-gray-400 capitalize">--</p>
          </div>
          <div class="w-full md:w-1/2 space-y-4">
            <p id="current-feels-like" class="text-lg">
              <i class="fas fa-temperature-high mr-2"></i> Feels like: --°
            </p>
            <p id="current-humidity" class="text-lg">
              <i class="fas fa-droplet mr-2"></i> Humidity: --%
            </p>
            <p id="current-wind" class="text-lg">
              <i class="fas fa-wind mr-2"></i> Wind: -- km/h
            </p>
            <p id="current-updated" class="text-sm text-gray-400 mt-4">
              Last updated: --
            </p>
          </div>
        </div>
      </div>
      
      <!-- 5-day forecast -->
      <h3 class="text-2xl font-bold mb-4">5-Day Forecast</h3>
      <div id="forecast-container" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4">
        <!-- Forecast cards will be dynamically inserted here -->
      </div>
    </div>
  </div>

  <script id="app-script">
    // Theme handling
    const body = document.body;
    const themeToggle = document.getElementById('theme-toggle');
    
    // Set initial theme from localStorage or default to dark
    const savedTheme = localStorage.getItem('weatherAppTheme') || 'dark';
    body.className = savedTheme;
    themeToggle.classList.toggle('active', savedTheme === 'dark');
    themeToggle.setAttribute('aria-checked', savedTheme === 'dark');
    
    themeToggle.addEventListener('click', () => {
      const isDark = body.classList.contains('dark');
      body.classList.toggle('dark');
      body.classList.toggle('light');
      themeToggle.classList.toggle('active');
      themeToggle.setAttribute('aria-checked', !isDark);
      localStorage.setItem('weatherAppTheme', isDark ? 'light' : 'dark');
    });
    
    themeToggle.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') {
        e.preventDefault();
        themeToggle.click();
      }
    });

    // DOM Elements
    const loadingContainer = document.getElementById('loading-container');
    const weatherContainer = document.getElementById('weather-container');
    const errorContainer = document.getElementById('error-container');
    const errorMessage = document.getElementById('error-message');
    const cityName = document.getElementById('city-name');
    const refreshBtn = document.getElementById('refresh-btn');
    const currentWeatherIcon = document.getElementById('current-weather-icon');
    const currentTemp = document.getElementById('current-temp');
    const currentDescription = document.getElementById('current-description');
    const currentFeelsLike = document.getElementById('current-feels-like');
    const currentHumidity = document.getElementById('current-humidity');
    const currentWind = document.getElementById('current-wind');
    const currentUpdated = document.getElementById('current-updated');
    const forecastContainer = document.getElementById('forecast-container');

    // Date formatter
    const formatDate = (timestamp) => {
      const date = new Date(timestamp * 1000);
      return date.toLocaleString('en-US', {
        weekday: 'short',
        month: 'short',
        day: 'numeric'
      });
    };

    const formatTime = (timestamp) => {
      const date = new Date(timestamp * 1000);
      return date.toLocaleString('en-US', {
        hour: 'numeric',
        minute: 'numeric',
        hour12: true
      });
    };

    // Show error message
    const showError = (message) => {
      errorMessage.textContent = message;
      errorContainer.classList.remove('hidden');
      loadingContainer.classList.add('hidden');
      weatherContainer.classList.add('hidden');
    };

    // Hide error message
    const hideError = () => {
      errorContainer.classList.add('hidden');
    };

    // Weather icon mapping function
    const getWeatherIconUrl = (iconCode) => {
      return `https://openweathermap.org/img/wn/${iconCode}@2x.png`;
    };

    // Create a forecast card
    const createForecastCard = (forecast) => {
      const card = document.createElement('div');
      card.className = 'forecast-card p-4 flex flex-col items-center';
      
      card.innerHTML = `
        <h4 class="font-medium mb-2">${forecast.day}</h4>
        <img src="${forecast.iconUrl}" alt="${forecast.description}" class="w-16 h-16">
        <p class="font-bold mt-1">${forecast.highTemp}° / ${forecast.lowTemp}°</p>
        <p class="text-sm text-gray-400 capitalize">${forecast.description}</p>
      `;
      
      return card;
    };

    // Display weather data
    const displayWeatherData = (data) => {
      // Hide loading, show weather, hide error
      loadingContainer.classList.add('hidden');
      weatherContainer.classList.remove('hidden');
      hideError();

      // Current weather
      currentWeatherIcon.src = data.current.iconUrl;
      currentWeatherIcon.alt = data.current.description;
      currentTemp.textContent = `${data.current.temp}°`;
      currentDescription.textContent = data.current.description;
      currentFeelsLike.innerHTML = `<i class="fas fa-temperature-high mr-2"></i> Feels like: ${data.current.feelsLike}°`;
      currentHumidity.innerHTML = `<i class="fas fa-droplet mr-2"></i> Humidity: ${data.current.humidity}%`;
      currentWind.innerHTML = `<i class="fas fa-wind mr-2"></i> Wind: ${data.current.windSpeed} km/h`;
      currentUpdated.textContent = `Last updated: ${data.current.lastUpdated}`;
      
      // City name
      cityName.textContent = data.location;
      
      // Clear previous forecast
      forecastContainer.innerHTML = '';
      
      // Add forecast cards
      data.forecast.forEach(day => {
        forecastContainer.appendChild(createForecastCard(day));
      });
      
      // Cache the data
      localStorage.setItem('weatherData', JSON.stringify({
        data: data,
        timestamp: Date.now()
      }));
    };

    // Get weather data
    const getWeatherData = async (latitude, longitude) => {
      try {
        // In a real application, this would make API calls to a weather service
        // For this prototype, we'll return mocked data

        // Simulate API delay
        await new Promise(resolve => setTimeout(resolve, 1500));

        // Example API response structure (this would normally come from a real API)
        const data = {
          location: "New York, NY",
          current: {
            temp: 22,
            feelsLike: 23,
            description: "partly cloudy",
            humidity: 65,
            windSpeed: 12,
            iconUrl: "https://openweathermap.org/img/wn/02d@2x.png",
            lastUpdated: formatTime(Math.floor(Date.now() / 1000))
          },
          forecast: [
            {
              day: "Today",
              highTemp: 24,
              lowTemp: 18,
              description: "partly cloudy",
              iconUrl: "https://openweathermap.org/img/wn/02d@2x.png"
            },
            {
              day: "Tomorrow",
              highTemp: 26,
              lowTemp: 19,
              description: "sunny",
              iconUrl: "https://openweathermap.org/img/wn/01d@2x.png"
            },
            {
              day: "Wed",
              highTemp: 25,
              lowTemp: 20,
              description: "cloudy",
              iconUrl: "https://openweathermap.org/img/wn/03d@2x.png"
            },
            {
              day: "Thu",
              highTemp: 22,
              lowTemp: 17,
              description: "rainy",
              iconUrl: "https://openweathermap.org/img/wn/10d@2x.png"
            },
            {
              day: "Fri",
              highTemp: 21,
              lowTemp: 16,
              description: "thunderstorm",
              iconUrl: "https://openweathermap.org/img/wn/11d@2x.png"
            }
          ]
        };
        
        displayWeatherData(data);
      } catch (error) {
        console.error('Error fetching weather data:', error);
        showError("Unable to retrieve weather data. Please try again later.");
      }
    };

    // Get location and fetch weather
    const getLocationAndWeather = () => {
      // Show loading state
      loadingContainer.classList.remove('hidden');
      weatherContainer.classList.add('hidden');
      hideError();
      
      // Try to get cached data first
      const cachedWeatherData = localStorage.getItem('weatherData');
      if (cachedWeatherData) {
        const { data, timestamp } = JSON.parse(cachedWeatherData);
        // Only use cached data if less than 30 minutes old
        const thirtyMinutesInMs = 30 * 60 * 1000;
        if (Date.now() - timestamp < thirtyMinutesInMs) {
          displayWeatherData(data);
        }
      }
      
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          position => {
            getWeatherData(position.coords.latitude, position.coords.longitude);
          },
          error => {
            console.error('Geolocation error:', error);
            // Fall back to default location if geolocation fails
            getWeatherData(40.7128, -74.0060); // New York coordinates
          }
        );
      } else {
        showError("Geolocation is not supported by your browser. Using default location.");
        getWeatherData(40.7128, -74.0060); // New York coordinates
      }
    };

    // Refresh button event listener
    refreshBtn.addEventListener('click', () => {
      getLocationAndWeather();
    });
    
    // Initialize the app
    document.addEventListener('DOMContentLoaded', () => {
      getLocationAndWeather();
    });
  </script>
</body>
</html>